version: "3.8"
services:
  broker:
    build:
      context: .
    env_file:
      - .env
  influxdb:
    restart: always    
    image: influxdb:1.8.2
    environment: 
      - INFLUXDB_ADMIN_USER=admin
      - INFLUXDB_ADMIN_PASSWORD=Tempelhof
      - INFLUXDB_USER=citylab
      - INFLUXDB_USER_PASSWORD=Tempelhof
      - INFLUXDB_READ_USER=citylab-read
      - INFLUXDB_READ_USER_PASSWORD=citylab-read
      - INFLUXDB_DB=Sensorfeld
      - INFLUXDB_HTTP_FLUX_ENABLED=true
    ports:
      - 8086:8086
  influxui:
    restart: always
    image: chronograf:latest
    environment:
      - INFLUXDB_URL=http://influxdb:8086
      - INFLUXDB_USERNAME=admin
      - INFLUXDB_PASSWORD=Tempelhof
  nginx:
    restart: always
    image: nginx
    volumes:
      - ./nginx.conf:/etc/nginx/conf.d/default.conf
    ports:
      - 80:80
      - 7000:81
      - 443:443
    
